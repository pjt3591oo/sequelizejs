

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>저수준 쿼리 &mdash; Sequelize Of Node.js translate V5 5 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="트랜잭션" href="../OtherTopics/Transactions.html" />
    <link rel="prev" title="관계" href="Associations.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Sequelize Of Node.js translate V5
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Home</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Home.html">Home</a></li>
</ul>
<p class="caption"><span class="caption-text">Core Concepts</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html">시작하기</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dialects.html">Dialects</a></li>
<li class="toctree-l1"><a class="reference internal" href="DateTypes.html">데이터 타입</a></li>
<li class="toctree-l1"><a class="reference internal" href="ModelDefinition.html">모델정의</a></li>
<li class="toctree-l1"><a class="reference internal" href="ModelUsage.html">모델사용</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hooks.html">훅스(후크)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Querying.html">쿼리(조회)</a></li>
<li class="toctree-l1"><a class="reference internal" href="Instances.html">인스턴스</a></li>
<li class="toctree-l1"><a class="reference internal" href="Associations.html">관계</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">저수준 쿼리</a></li>
</ul>
<p class="caption"><span class="caption-text">Other Topic</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../OtherTopics/Transactions.html">트랜잭션</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OtherTopics/Scopes.html">범위</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OtherTopics/ReadReplication.html">대체 읽기</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OtherTopics/Migrations.html">마이그레이션</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OtherTopics/Resources.html">리소스</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OtherTopics/TypeScript.html">타입스크립트</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OtherTopics/UpgradeToV5.html">5버전 업그레이드</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OtherTopics/WorkingWithLegacyTables.html">레거시 테이블 작업</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sequelize Of Node.js translate V5</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>저수준 쿼리</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/CoreConcepts/RawQueries.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>저수준 쿼리<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>저수준/이미 준비된 SQL 쿼리를 실행하는 것이 더 쉬운 사용사례가 있습니다. <code class="docutils literal notranslate"><span class="pre">sequelize.query</span></code> 함수를 사용하 수 있습니다.</p>
<p>기본적으로 함수는 2개의 인자를 리스트 형태로 반환하며 각 요소는 메타데이터가 포함된 객체입니다. 이것은 원시데이터 이므로 메타데이터는 dialect에따라 다릅니다. 일부 dialect는 배열의 속성으로 결과 개체 “within”에 메타 데이터를 반환합니다. 그러나 구대의 인자는 항상 반환되며, 그러나 MSSQL과 MySQL의 경우 동일한 객체에 대한 두 개를 참조합니다.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">sequelize</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;UPDATE users SET y = 42 WHERE x = 12&quot;</span><span class="p">).</span><span class="nx">then</span><span class="p">(([</span><span class="nx">results</span><span class="p">,</span> <span class="nx">metadata</span><span class="p">])</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="c1">// Results will be an empty array and metadata will contain the number of affected rows.</span>
<span class="p">})</span>
</pre></div>
</div>
<p>메타데이터 접근이 필요 없는경우 쿼리 형식을 전달하여 결과의 형식을 지정하는 방법을 시퀀스에 전달할 수 있습니다. 예를 들어 간단한 조회 쿼리의 경우 다음을 수행 할 수 있습니다.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">sequelize</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM `users`&quot;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">QueryTypes</span><span class="p">.</span><span class="nx">SELECT</span><span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">users</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// We don&#39;t need spread here, since only the results will be returned for select queries</span>
  <span class="p">})</span>
</pre></div>
</div>
<p>몇 가지 다른 쿼리 타입을 사용할 수 있습니다. <a class="reference external" href="https://github.com/sequelize/sequelize/blob/master/lib/query-types.js">더 자세한 코드를 보려면 누르세요.</a></p>
<p>두 번째 옵션은 모델입니다. 모델을 전달하면 반환 된 데이터는 해당 모델의 인스턴스입니다.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="c1">// Callee is the model definition. This allows you to easily map a query to a predefined model</span>
<span class="nx">sequelize</span>
  <span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM projects&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">model</span><span class="o">:</span> <span class="nx">Projects</span><span class="p">,</span>
    <span class="nx">mapToModel</span><span class="o">:</span> <span class="kc">true</span> <span class="c1">// pass true here if you have any mapped fields</span>
  <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">projects</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="c1">// Each record will now be an instance of Project</span>
  <span class="p">})</span>
</pre></div>
</div>
<p>쿼리 <a class="reference external" href="https://sequelize.org/master/class/lib/sequelize.js~Sequelize.html#instance-method-query">API 참조</a>에서 더 많은 옵션을 참조하십시오. 아래 몇 가지 예 :</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">sequelize</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT 1&#39;</span><span class="p">,</span> <span class="p">{</span>
  <span class="c1">// A function (or false) for logging your queries</span>
  <span class="c1">// Will get called for every SQL query that gets sent</span>
  <span class="c1">// to the server.</span>
  <span class="nx">logging</span><span class="o">:</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">,</span>

  <span class="c1">// If plain is true, then sequelize will only return the first</span>
  <span class="c1">// record of the result set. In case of false it will return all records.</span>
  <span class="nx">plain</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>

  <span class="c1">// Set this to true if you don&#39;t have a model definition for your query.</span>
  <span class="nx">raw</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>

  <span class="c1">// The type of query you are executing. The query type affects how results are formatted before they are passed back.</span>
  <span class="nx">type</span><span class="o">:</span> <span class="nx">Sequelize</span><span class="p">.</span><span class="nx">QueryTypes</span><span class="p">.</span><span class="nx">SELECT</span>
<span class="p">})</span>

<span class="c1">// Note the second argument being null!</span>
<span class="c1">// Even if we declared a callee here, the raw: true would</span>
<span class="c1">// supersede and return a raw object.</span>
<span class="nx">sequelize</span>
  <span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM projects&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">raw</span><span class="o">:</span> <span class="kc">true</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">projects</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">projects</span><span class="p">)</span>
  <span class="p">})</span>
</pre></div>
</div>
<div class="section" id="dotted">
<h2>“Dotted” 속성<a class="headerlink" href="#dotted" title="Permalink to this headline">¶</a></h2>
<p>테이블의 속성 이름에 점이 포함되어 있으면 결과 개체가 중첩됩니다. 이것은 후드에서 dottie.js를 사용하기 때문입니다.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">sequelize</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;select 1 as `foo.bar.baz`&#39;</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">rows</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">rows</span><span class="p">))</span>
<span class="p">})</span>
</pre></div>
</div>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span>
  <span class="s2">&quot;foo&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;bar&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;baz&quot;</span><span class="o">:</span> <span class="mi">1</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}]</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h2>대체자<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>쿼리에서 대체는 이미 정의된 매개변수(<code class="docutils literal notranslate"><span class="pre">:</span></code>로 시작)를 사용하거나 이미 정의되지 않은 <code class="docutils literal notranslate"><span class="pre">?</span></code>로 표시하는 방법이 있습니다. 교체는 옵션 개체에 전달됩니다.</p>
<ul class="simple">
<li><p>배열이 전달되면 <code class="docutils literal notranslate"><span class="pre">?</span></code> 배열에 나타나는 순서대로 교체됩니다</p></li>
<li><p>객체가 전달되면 <code class="docutils literal notranslate"><span class="pre">:</span> <span class="pre">key</span></code>가 해당 객체의 키로 대체됩니다. 개체에 쿼리에서 찾을 수없는 키가 포함 된 경우 또는 그 반대의 경우 예외가 발생합니다.</p></li>
</ul>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">sequelize</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM projects WHERE status = ?&#39;</span><span class="p">,</span>
  <span class="p">{</span> <span class="nx">replacements</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">],</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">QueryTypes</span><span class="p">.</span><span class="nx">SELECT</span> <span class="p">}</span>
<span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">projects</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">projects</span><span class="p">)</span>
<span class="p">})</span>

<span class="nx">sequelize</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM projects WHERE status = :status &#39;</span><span class="p">,</span>
  <span class="p">{</span> <span class="nx">replacements</span><span class="o">:</span> <span class="p">{</span> <span class="nx">status</span><span class="o">:</span> <span class="s1">&#39;active&#39;</span> <span class="p">},</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">QueryTypes</span><span class="p">.</span><span class="nx">SELECT</span> <span class="p">}</span>
<span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">projects</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">projects</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
<p>배열 교체는 자동으로 처리되며 다음 쿼리는 상태가 값 배열과 일치하는 프로젝트를 검색합니다.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">sequelize</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM projects WHERE status IN(:status) &#39;</span><span class="p">,</span>
  <span class="p">{</span> <span class="nx">replacements</span><span class="o">:</span> <span class="p">{</span> <span class="nx">status</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">,</span> <span class="s1">&#39;inactive&#39;</span><span class="p">]</span> <span class="p">},</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">QueryTypes</span><span class="p">.</span><span class="nx">SELECT</span> <span class="p">}</span>
<span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">projects</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">projects</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
<p>와일드 카드 연산자 <code class="docutils literal notranslate"><span class="pre">%</span></code>를 사용하려면 이를 대체 문자에 추가하십시오. 다음 쿼리는 이름이 ‘ben’으로 시작하는 사용자를 찾습니다.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">sequelize</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT * FROM users WHERE name LIKE :search_name &#39;</span><span class="p">,</span>
  <span class="p">{</span> <span class="nx">replacements</span><span class="o">:</span> <span class="p">{</span> <span class="nx">search_name</span><span class="o">:</span> <span class="s1">&#39;ben%&#39;</span>  <span class="p">},</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">QueryTypes</span><span class="p">.</span><span class="nx">SELECT</span> <span class="p">}</span>
<span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">projects</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">projects</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2>파라미터 바인드<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>파라미터 바인드는 대체자와 비슷합니다. 대체자는 SQL 쿼리 텍스트 외부의 데이터베이스로 전송되는 반면, 바인드 매개 변수는 데이터베이스로 전송되기 전에 대체가 이스케이프되고 쿼리에 삽입되어 제외됩니다. 쿼리는 바인드 매개 변수 또는 대체자를 가질 수 있습니다. 바인드 매개변수는 $1, $2, …(숫자) Ehsms $key (영숫자)로 참조합니다. 이것은 다른 데이터에 의존적이지 않습니다.</p>
<ul class="simple">
<li><p>배열이 전달되면 $1은 배열의 첫 번째 요소에 바인딩됩니다 (bind [0]).</p></li>
<li><p>객체가 전달되면 $key는 object [‘key’]에 바인딩됩니다. 각 키는 숫자가 아닌 문자로 시작해야합니다. object [‘1’]이 있어도 $1은 유효한 키가 아닙니다.</p></li>
<li><p>두 경우 모두 $$를 사용하여 리터럴 $ 기호를 이스케이프 할 수 있습니다.</p></li>
</ul>
<p>배열이나 객체는 모든 바인딩 값을 포함해야합니다. 그렇지 않으면 Sequelize에서 예외가 발생합니다. 이는 데이터베이스가 바인드 된 매개 변수를 무시할 수있는 경우에도 적용됩니다.</p>
<p>데이터베이스에 이에 대한 추가 제한 사항이 추가 될 수 있습니다. 바인드 매개 변수는 SQL 키워드 나 테이블 또는 열 이름이 될 수 없습니다. 인용 된 텍스트 나 데이터에서도 무시됩니다. PostgreSQL에서는 <code class="docutils literal notranslate"><span class="pre">$1::varchar</span></code> 컨텍스트에서 형식을 유추 할 수없는 경우 형식을 변환해야 할 수도 있습니다.</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="nx">sequelize</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT *, &quot;text with literal $$1 and literal $$status&quot; as t FROM projects WHERE status = $1&#39;</span><span class="p">,</span>
  <span class="p">{</span> <span class="nx">bind</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;active&#39;</span><span class="p">],</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">QueryTypes</span><span class="p">.</span><span class="nx">SELECT</span> <span class="p">}</span>
<span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">projects</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">projects</span><span class="p">)</span>
<span class="p">})</span>

<span class="nx">sequelize</span><span class="p">.</span><span class="nx">query</span><span class="p">(</span><span class="s1">&#39;SELECT *, &quot;text with literal $$1 and literal $$status&quot; as t FROM projects WHERE status = $status&#39;</span><span class="p">,</span>
  <span class="p">{</span> <span class="nx">bind</span><span class="o">:</span> <span class="p">{</span> <span class="nx">status</span><span class="o">:</span> <span class="s1">&#39;active&#39;</span> <span class="p">},</span> <span class="nx">type</span><span class="o">:</span> <span class="nx">sequelize</span><span class="p">.</span><span class="nx">QueryTypes</span><span class="p">.</span><span class="nx">SELECT</span> <span class="p">}</span>
<span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">projects</span> <span class="p">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">projects</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../OtherTopics/Transactions.html" class="btn btn-neutral float-right" title="트랜잭션" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Associations.html" class="btn btn-neutral float-left" title="관계" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, pjt3591oo

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>